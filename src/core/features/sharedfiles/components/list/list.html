<ion-refresher slot="fixed" [disabled]="!filesLoaded" (ionRefresh)="refreshFiles($event.target)">
    <ion-refresher-content pullingText="{{ 'core.pulltorefresh' | translate }}" />
</ion-refresher>

<!-- Allow selecting the site to view. -->
@if (showSitePicker) {
    <core-site-picker [hidden]="!filesLoaded" [initialSite]="siteId" (siteSelected)="changeSite($event)" />
}

<core-loading [hideUntil]="filesLoaded" [fullscreen]="false">
    @if (files && files.length > 0) {
        <ion-list>
            @for (file of files; track file; let idx = $index) {

                @if (file.isFile) {
                    <core-local-file [file]="file" [manage]="manage" [overrideClick]="pick" (onClick)="filePicked(file)"
                        (onDelete)="fileDeleted(idx)" (onRename)="fileRenamed(idx, $event)" />
                }

                @if (!file.isFile) {
                    <ion-item button class="ion-text-wrap item-file item-directory" (click)="openFolder(file)" [detail]="true">
                        <ion-icon name="fas-folder" slot="start" [attr.aria-label]="'core.folder' | translate" />
                        <ion-label>{{ file.name }}</ion-label>
                    </ion-item>
                }

            }
        </ion-list>
    }

    @if (files && !files.length && manage) {
        <core-empty-box icon="fas-folder" [message]="'core.sharedfiles.nosharedfiles' | translate" />
    }

    @if (files && !files.length && !manage) {
        <core-empty-box icon="fas-folder" [message]="'core.sharedfiles.nosharedfilestoupload' | translate" />
    }
</core-loading>
